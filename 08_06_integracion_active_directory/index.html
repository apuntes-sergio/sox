<!DOCTYPE html><html lang="es" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Redes híbridas. Linux Server e integración básica con Windows.">
      
      
        <meta name="author" content="Sergio Rey Martínez">
      
      
        <link rel="canonical" href="https://sergio-apuntes.github.io/sox/08_06_integracion_active_directory/">
      
      
        <link rel="prev" href="../08_05_instalacion_configuracion_samba/">
      
      
        <link rel="next" href="../08_07_cron-rsync/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Integración con Active Directory usando Winbind - Apuntes Sistemas Operativos en Red</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#preparacion-del-entorno" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="Apuntes Sistemas Operativos en Red" class="md-header__button md-logo" aria-label="Apuntes Sistemas Operativos en Red" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Apuntes Sistemas Operativos en Red
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Integración con Active Directory usando Winbind
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Cambiar a modo oscuro" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Cambiar a modo claro" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Apuntes Sistemas Operativos en Red" class="md-nav__button md-logo" aria-label="Apuntes Sistemas Operativos en Red" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    Apuntes Sistemas Operativos en Red
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Presentación
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Presentación
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD01 Introducción a los Sistemas Operativos de Servidor
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD01 Introducción a los Sistemas Operativos de Servidor
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_1_introducci%C3%B3n/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_2_arquitectura_cliente_servidor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arquitectura cliente/servidor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_3_funciones_SO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Funciones de Sistemas Operativos en Red
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_4_sistemas_operativos_servidor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Principales sistemas operativos servidor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_5_recordatorio_red/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Repaso conceptos de red
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD02 Instalación de sistemas operativos de servidor privativos
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD02 Instalación de sistemas operativos de servidor privativos
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_1_instalacion_SO_introduccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_2_instalacion_windows_server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instalación de Windows Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_3_config_basica/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuración básica
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_4_documentar_instalacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentación
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_5_administrar_discos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Administrar discos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_6_dominio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD03 Administración de usuarios y grupos en Windows Server
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD03 Administración de usuarios y grupos en Windows Server
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_01_objetos_dominios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Objetos del Dominio en Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_02_usuarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cuentas de Usuario en un Dominio Windows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_03_grupos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grupos en Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_04_equipos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Equipos en Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_05_unidades_organizativas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unidades Organizativas en Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_06_herramientas_administracion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Herramientas de administración en Windows Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_07_perfiles_usuarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Perfiles de usuario en Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD04 Gestión de recursos compartidos en Windows Server
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD04 Gestión de recursos compartidos en Windows Server
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_01_permisos_derechos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Permisos y derechos en sistemas Windows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_02_servidor_archivos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    El servidor de archivos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_03_compartir_impresoras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compartir impresoras en red
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6">
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD05 Directivas de grupo en Windows Server
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD05 Directivas de grupo en Windows Server
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_01_introduccion_directivas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción a las directivas de grupo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_02_creacion_directivas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Creación y ámbito de aplicación de GPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_03_herencia_directivas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Herencia de directivas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_04_configuacion_directivas_comunes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuración de directivas comunes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_05_verificacion_problemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Verificación y resolución de problemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7">
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD06 Configuración avanzada de Windows Server
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD06 Configuración avanzada de Windows Server
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_01_configuraciones_adicionales/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuración avanzada de Windows Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_02_carpetas_compartidas_ocultas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recursos Compartidos Ocultos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_03_cuotas_discos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cuotas de discos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_04_servidor_dhcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Servidor DHCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_05_escritorio_remoto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Escritorio Remoto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_06_redes_virtuales_VPN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Red VPN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_07_rsat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Herramientas de Administración Remota del Servidor (RSAT)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_08_backups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Copias de seguridad
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_09_controlador_secundario/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Controlador de Dominio Secundario
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_10_supervision_monitorizacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitorización Windows Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_11_servicios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Servicios en Windows Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_12_actualizacion_despliegue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WSUS &amp; WDS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8">
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD07 Instalación de sistemas operativos libres
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD07 Instalación de sistemas operativos libres
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_01_introduccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción. Redes heterogéneas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_02_ubuntudesktop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ubuntu Desktop. Primeros pasos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_03_ubuntudesktop_red/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ubuntu Desktop. Configuración de red con Netplan y NetworkManager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_04_ubuntudesktop_varios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ubuntu Desktop. Organización de discos y carpetas en Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_05_ubuntudesktop_ad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ubuntu Desktop. Integración con Active Directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD08 Linux Server e integración básica con Windows
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD08 Linux Server e integración básica con Windows
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_01_instalacion_ubuntu_server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instalación de Ubuntu Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_02_configuracion_red_netplan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuración de red estática con Netplan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_03_gestion_almacenamiento_linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gestión básica de almacenamiento en Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_04_gestion_almacenamiento_lvm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gestión de almacenamiento con LVM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_05_instalacion_configuracion_samba/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instalación y configuración básica de Samba
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Integración con Active Directory usando Winbind
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Integración con Active Directory usando Winbind
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preparacion-del-entorno" class="md-nav__link">
    <span class="md-ellipsis">
      
        Preparación del entorno
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preparación del entorno">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracion-de-red-y-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración de red y DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-del-archivo-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración del archivo hosts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificacion-de-conectividad" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificación de conectividad
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolucion-dns-del-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resolución DNS del dominio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sincronizacion-de-hora" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sincronización de hora
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalacion-de-software-necesario" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalación de software necesario
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-del-sistema-de-nombres" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración del sistema de nombres
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-samba-y-winbind" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración de Samba y Winbind
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#union-al-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unión al dominio
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verificacion-de-la-integracion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificación de la integración
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verificación de la integración">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verificar-la-union-al-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificar la unión al dominio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificar-usuarios-y-grupos-del-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificar usuarios y grupos del dominio
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-recursos-compartidos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración de recursos compartidos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuración de recursos compartidos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crear-el-directorio-para-compartir" class="md-nav__link">
    <span class="md-ellipsis">
      
        Crear el directorio para compartir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-permisos-del-sistema-de-archivos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurar permisos del sistema de archivos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-el-recurso-compartido-en-samba" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurar el recurso compartido en Samba
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acceso-desde-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Acceso desde Windows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Acceso desde Windows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gestion-de-permisos-desde-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestión de permisos desde Windows
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verificaciones-finales-desde-el-servidor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificaciones finales desde el servidor
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solucion-de-problemas-comunes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solución de problemas comunes
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_07_cron-rsync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Administración avanzada - Automatización y copias de seguridad
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_08_mantenimiento_logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mantenimiento y control - Monitorización y logs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10">
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UD09 Script de administración en Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    UD09 Script de administración en Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_01_introduccion_scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción y scripts básicos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_02_condicionales/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Condicionales y Verificación de Archivos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_03_bucles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bucles for y Procesamiento de Archivos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_04_backups_tar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Uso Profesional de tar para Backups
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_05_rsync_cron/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sincronización con rsync y Automatización con cron
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_06_logs_grep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logs y Control con Redirección
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preparacion-del-entorno" class="md-nav__link">
    <span class="md-ellipsis">
      
        Preparación del entorno
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preparación del entorno">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracion-de-red-y-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración de red y DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-del-archivo-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración del archivo hosts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificacion-de-conectividad" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificación de conectividad
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolucion-dns-del-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resolución DNS del dominio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sincronizacion-de-hora" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sincronización de hora
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalacion-de-software-necesario" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalación de software necesario
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-del-sistema-de-nombres" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración del sistema de nombres
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-samba-y-winbind" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración de Samba y Winbind
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#union-al-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unión al dominio
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verificacion-de-la-integracion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificación de la integración
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verificación de la integración">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verificar-la-union-al-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificar la unión al dominio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificar-usuarios-y-grupos-del-dominio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificar usuarios y grupos del dominio
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-recursos-compartidos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuración de recursos compartidos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuración de recursos compartidos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crear-el-directorio-para-compartir" class="md-nav__link">
    <span class="md-ellipsis">
      
        Crear el directorio para compartir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-permisos-del-sistema-de-archivos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurar permisos del sistema de archivos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-el-recurso-compartido-en-samba" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurar el recurso compartido en Samba
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acceso-desde-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Acceso desde Windows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Acceso desde Windows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gestion-de-permisos-desde-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestión de permisos desde Windows
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verificaciones-finales-desde-el-servidor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificaciones finales desde el servidor
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solucion-de-problemas-comunes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solución de problemas comunes
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Integración con Active Directory usando Winbind</h1>

<p>Ahora llega la parte más interesante y compleja de este tema: vamos a unir nuestro servidor Linux al dominio Active Directory de Windows Server que creamos en temas anteriores.</p>
<p>Una vez completada esta integración, conseguiremos que:</p>
<ul>
<li>Los usuarios del dominio Windows puedan autenticarse en el servidor Linux con sus credenciales del AD</li>
<li>Los recursos compartidos en Linux respeten los permisos y grupos del Active Directory</li>
<li>Podamos gestionar permisos desde Windows de forma nativa, usando la interfaz gráfica que ya conocemos</li>
<li>Todo funcione de forma transparente: los usuarios no notarán diferencia entre recursos Windows y Linux</li>
</ul>
<p>Esta configuración es habitual en empresas con infraestructuras híbridas y representa una habilidad muy valorada profesionalmente. A diferencia de otras soluciones como SSSD, utilizaremos <strong>Winbind</strong>, que ofrece una integración más profunda con Active Directory y permite una gestión más completa de ACLs de Windows.</p>
<h2 id="preparacion-del-entorno">Preparación del entorno</h2>
<p>Antes de comenzar el proceso de integración, debemos asegurarnos de que nuestro servidor Linux tiene correctamente configurados varios aspectos fundamentales de red e identificación.</p>
<h3 id="configuracion-de-red-y-dns">Configuración de red y DNS</h3>
<p>El primer paso crítico es asegurar que nuestro servidor puede comunicarse correctamente con el controlador de dominio y, especialmente, que puede resolver nombres del dominio.</p>
<p>Este paso ya lo tenemos hecho, pero es fundamental que nos aseguremos de que todo esta correcto. Para ellos, editamos la configuración de red de Netplan:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/netplan/00-installer-config.yaml
</span></code></pre></div>
<p>La configuración debe apuntar al Windows Server como servidor DNS primario. Es fundamental que el DNS sea el del controlador de dominio, ya que Active Directory depende completamente de DNS para funcionar:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">network</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="nt">ethernets</span><span class="p">:</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nt">enp0s3</span><span class="p">:</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">      </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">      </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192.168.100.10/24</span><span class="p p-Indicator">]</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">      </span><span class="nt">routes</span><span class="p">:</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">          </span><span class="nt">via</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.100.1</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">      </span><span class="nt">nameservers</span><span class="p">:</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">        </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192.168.100.1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.1.1.1</span><span class="p p-Indicator">]</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">        </span><span class="nt">search</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">DOMXXX.local</span><span class="p p-Indicator">]</span>
</span></code></pre></div>
<p>Sustituimos <code>DOMXXX</code> por el nombre real de nuestro dominio. La directiva <code>search</code> permite que podamos usar nombres cortos (como <code>servidor</code>) en lugar del nombre completo (como <code>servidor.domxxx.local</code>).</p>
<p>Aplicamos los cambios:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo<span class="w"> </span>netplan<span class="w"> </span>apply
</span></code></pre></div>
<h3 id="configuracion-del-archivo-hosts">Configuración del archivo hosts</h3>
<p>Para evitar problemas de resolución de nombres, especialmente con el propio servidor, configuramos el archivo <code>/etc/hosts</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/hosts
</span></code></pre></div>
<p>Añadimos o modificamos las siguientes líneas:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>127.0.0.1       localhost
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>192.168.100.10  ubuntuserver.domXXX.local  ubuntuserver
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>192.168.100.1   srvXXX.domXXX.local srvXXX domXXX.local
</span></code></pre></div>
<p>La última línea es especialmente importante: asegura que cuando el sistema intente resolver el nombre del dominio, encuentre directamente la IP del controlador de dominio.</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/hosts.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/hosts.png" width="80%"></a>
<br>
<figcaption>contenido de fichero /etc/hosts</figcaption>
</figure>
<p>No es indispensable, pero es aconsejable poner todo en <strong>minúsculas</strong></p>
<h3 id="verificacion-de-conectividad">Verificación de conectividad</h3>
<p>Antes de continuar, verificamos que todo funciona correctamente.</p>
<p>Comprobamos que podemos hacer ping al controlador de dominio:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>ping<span class="w"> </span>-c<span class="w"> </span><span class="m">3</span><span class="w"> </span>DOMXXX.local
</span></code></pre></div>
<p>Deberíamos recibir respuestas desde la IP del Windows Server (192.168.100.1).</p>
<p>Si alguna de estas pruebas falla, debemos revisar la configuración antes de continuar.</p>
<h3 id="resolucion-dns-del-dominio">Resolución DNS del dominio</h3>
<p>Este es uno de los puntos más críticos. El servidor Linux debe poder resolver el nombre del dominio Active Directory. Para ello, <strong>debe usar el Windows Server como servidor DNS</strong>.</p>
<p>Probamos la resolución del dominio:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>nslookup<span class="w"> </span>DOMXXX.local
</span></code></pre></div>
<p>(Sustituimos DOMXXX por el nombre real de vuestro dominio)</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/nslookup.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/nslookup.png" width="80%"></a>
<br>
<figcaption>Prueba de resolución de nombres del dominio</figcaption>
</figure>
<p>Si funciona, debería mostrar la IP del Windows Server. Si da error "server can't find...", hay un problema de DNS que debemos resolver antes de continuar.</p>
<div class="admonition tip">
<p class="admonition-title">Si el servidor DNS no resuelve bien la dirección del DOMXXX</p>
<p>Como tenemos un sistema muy complejo, es posible que el servidor DNS de nuestro Windows Server resuelva que la dirección del DOMSERGIO.local es 10.0.2.15, que es la IP de la tarjeta de red externa, y por lo tanto inaccesible para nuestro servidor Ubuntu.</p>
<p>Para solucionar esto, debemos corregir el registro en el Servidor DNS (Windows Server) e indicarle al servicio DNS que no "escuche" ni responda por las interfaces que no pertenecen a tu red de gestión (como la de NAT de VirtualBox 10.0.2.15).</p>
<p>En el Windows Server, abre el Administrador de DNS:</p>
<ul>
<li>Haz clic derecho sobre el nombre del servidor y selecciona Propiedades.</li>
<li>Ve a la pestaña Interfaces.</li>
<li>Cambia la selección a "Solo las siguientes direcciones IP".</li>
<li>Desmarca la casilla de la IP 10.0.2.15 y asegúrate de que solo la 192.168.100.1 esté marcada.</li>
<li>Aplica los cambios.</li>
</ul>
<p></p><figure markdown="span" align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/correccionDNS.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/correccionDNS.png" width="80%"></a>
  <figcaption>Corrección de la resolución de nombres DNS</figcaption>
</figure><p></p>
<p>También tienes que eliminar manualmente las zonas directas de búsqueda que no sean la tarjeta de red correcta. Al final debe quedar algo similar a la siguiente imagen:</p>
<p></p><figure markdown="span" align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/correccionDNSdirecto.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/correccionDNSdirecto.png" width="80%"></a>
  <figcaption>Correcicón de la resolución de nombres DNS</figcaption>
</figure><p></p>
<p>Después de todo esto, reinicia las DNS que tiene tu servidor ubuntu ejecutando</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>sudo<span class="w"> </span>resolvectl<span class="w"> </span>flush-caches
</span></code></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">nslookup no instalado</p>
<p>Si no teníamos <code>nslookup</code> instalado:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>dnsutils
</span></code></pre></div>
<p>También podemos probar con:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>host<span class="w"> </span>DOMXXX.local
</span></code></pre></div>
<p>o</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>dig<span class="w"> </span>DOMXXX.local
</span></code></pre></div>
</div>
<h3 id="sincronizacion-de-hora">Sincronización de hora</h3>
<p>La autenticación Kerberos (que usa Active Directory) es extremadamente sensible a diferencias de hora. Si el reloj del servidor Linux y del Windows Server difieren en más de 5 minutos, la autenticación fallará.</p>
<p>Instalamos el cliente NTP para sincronización de hora:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>chrony
</span></code></pre></div>
<p>Verificamos que el servicio está activo:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>chronyd
</span></code></pre></div>
<p>Verificamos la sincronización:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>timedatectl
</span></code></pre></div>
<p>Deberíamos ver:</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/timedatectl.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/timedatectl.png" width="80%"></a>
<br>
<figcaption>Verificación de la sincronización de reloj</figcaption>
</figure>
<p>La línea clave es <code>System clock synchronized: yes</code>. Si muestra <code>no</code>, esperamos un minuto y volvemos a verificar.</p>
<p>También podemos ejecutar el estado de la sincronización mediante el comando:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>chronyc sources -v
</span></code></pre></div>
<p>Si no tenemos completamente el reloj sincronizado, pero estamos en hora, el sistema puede funcionar perfectamente.</p>
<p>Opcionalmente, podemos configurar el servidor NTP para que use el Windows Server como fuente de hora añadiendo al fichero <code>/etc/chrony/chrony.conf</code> una línea con el texto server <code>192.168.100.1 iburst prefer trust</code>, pero con chrony configurado por defecto suele ser suficiente.</p>
<h2 id="instalacion-de-software-necesario">Instalación de software necesario</h2>
<p>Para unir Linux a Active Directory usando Winbind necesitamos varios paquetes que gestionan la autenticación, la comunicación con el AD y la integración con Samba.</p>
<p>Actualizamos la lista de paquetes e instalamos todo lo necesario:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>samba<span class="w"> </span>winbind<span class="w"> </span>libnss-winbind<span class="w"> </span>libpam-winbind<span class="w"> </span>krb5-config
</span></code></pre></div>
<p>Durante la instalación de <code>krb5-config</code>, el sistema nos preguntará por el "Default Realm". Es muy importante introducir el nombre del dominio <strong>en mayúsculas</strong>: <code>DOMXXX.LOCAL</code>.</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/krb5-config.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/krb5-config.png" width="80%"></a>
<br>
<figcaption>Configuración del paquete krb5-config durante la instalación</figcaption>
</figure>
<p>Para el resto de preguntas que nos hará no es necesario introducir nada.</p>
<div class="admonition note">
<p class="admonition-title">Explicación de los paquetes principales</p>
<ul>
<li><code>samba</code>: proporciona los servicios de compartición de archivos compatibles con Windows</li>
<li><code>winbind</code>: demonio que permite que Linux use usuarios y grupos de Active Directory</li>
<li><code>libnss-winbind</code> y <code>libpam-winbind</code>: integran Winbind con el sistema de autenticación de Linux</li>
<li><code>krb5-config</code>: configuración de Kerberos, el protocolo de autenticación que usa Active Directory</li>
</ul>
</div>
<p>La instalación puede tardar varios minutos. Al final, el sistema puede pedir que reiniciemos servicios para aplicar cambios, lo cual aceptamos.</p>
<h2 id="configuracion-del-sistema-de-nombres">Configuración del sistema de nombres</h2>
<p>Linux necesita saber dónde buscar información sobre usuarios y grupos. Por defecto, solo busca en los archivos locales (<code>/etc/passwd</code>, <code>/etc/group</code>), pero necesitamos que también consulte a Winbind para obtener usuarios del Active Directory.</p>
<p>Editamos el archivo que controla este comportamiento:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nsswitch.conf
</span></code></pre></div>
<p>Modificamos las líneas de <code>passwd</code>, <code>group</code> y <code>shadow</code> para que incluyan <code>winbind</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>passwd:         files systemd winbind
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>group:          files systemd winbind
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>shadow:         files systemd
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>gshadow:        files systemd
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>hosts:          files dns
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>networks:       files
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Explicación del orden</p>
<ul>
<li><code>files</code>: primero busca en archivos locales (usuarios y grupos del sistema)</li>
<li><code>systemd</code>: después consulta usuarios dinámicos de systemd</li>
<li><code>winbind</code>: finalmente consulta el Active Directory a través de Winbind</li>
</ul>
<p>Este orden es importante: asegura que los usuarios del sistema local (como <code>root</code>) siempre funcionen, incluso si hay problemas con Active Directory.</p>
</div>
<h2 id="configuracion-de-samba-y-winbind">Configuración de Samba y Winbind</h2>
<p>Ahora viene la parte más importante: configurar Samba y Winbind para que trabajen con nuestro Active Directory. Esta configuración es completa y permite tanto la autenticación de usuarios como la gestión de permisos de Windows en carpetas Linux.</p>
<p>Vamos a crear el fichero de configuración de samba desde cero, por lo cual vamos a renombrar el fichero de configuración por defecto, por si en un futuro nos hiciera falta_</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>sudo mv /etc/samba/smb.conf /etc/samba/smb.conf.bak
</span></code></pre></div>
<p>y ahora editamos el archivo principal de configuración de Samba, que estará vacío:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/samba/smb.conf
</span></code></pre></div>
<p>Escribimos el siguiente contenido en el fichero. </p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">[global]</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">   </span><span class="na">workgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">DOMXXX</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">   </span><span class="na">realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">DOMXXX.LOCAL</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">   </span><span class="na">security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">ADS</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">   </span><span class="c1"># Configuración de Winbind y mapeo de IDs</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">   </span><span class="na">idmap config *</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">backend = tdb</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">   </span><span class="na">idmap config *</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">range = 3000-7999</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">   </span><span class="na">idmap config DOMXXX</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">backend = rid</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">   </span><span class="na">idmap config DOMXXX</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">range = 10000-999999</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">   </span><span class="na">template shell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/bin/bash</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">   </span><span class="na">template homedir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/home/%U</span><span class="w"> </span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">   </span><span class="c1"># Configuración de Winbind y Enumeración</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">   </span><span class="na">winbind use default domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">   </span><span class="na">winbind enum users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">   </span><span class="na">winbind enum groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">   </span><span class="na">winbind refresh tickets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">   </span><span class="c1"># Logging y Red</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">   </span><span class="na">log file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/samba/log.%m</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">   </span><span class="na">max log size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1000</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">   </span><span class="na">interfaces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">lo 192.168.100.0/24</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="w">   </span><span class="na">bind interfaces only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="w">   </span><span class="na">password server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">192.168.100.1</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="w">   </span><span class="c1"># Soporte ACLs de Windows</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="w">   </span><span class="na">vfs objects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">acl_xattr</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="w">   </span><span class="na">map acl inherit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="w">   </span><span class="na">store dos attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span></code></pre></div>
<p><strong>IMPORTANTE</strong>: Sustituimos todas las ocurrencias de <code>DOMXXX</code> por el nombre real de nuestro dominio.</p>
<div class="admonition note">
<p class="admonition-title">Explicación de las secciones principales:</p>
<p><strong>Identificación del dominio</strong>:</p>
<ul>
<li><code>workgroup</code>: nombre NetBIOS del dominio (la parte antes del <code>.local</code>)</li>
<li><code>realm</code>: nombre completo del dominio en mayúsculas</li>
<li><code>security = ADS</code>: usar Active Directory Security</li>
</ul>
<p><strong>Mapeo de identificadores</strong>: Las líneas <code>idmap</code> son cruciales. Active Directory identifica usuarios con SIDs (Security Identifiers), mientras que Linux usa UIDs y GIDs numéricos. Esta configuración establece cómo se traducen:</p>
<ul>
<li><code>idmap config *</code>: configuración por defecto para dominios desconocidos (rango 3000-7999)</li>
<li><code>idmap config DOMXXX</code>: configuración específica para nuestro dominio usando el método RID (rango 10000-999999)</li>
</ul>
<p><strong>Configuración de Winbind</strong>:</p>
<ul>
<li><code>winbind use default domain = yes</code>: permite usar nombres cortos (solo <code>usuario</code> en lugar de <code>DOMXXX\usuario</code>)</li>
<li><code>winbind enum users/groups = yes</code>: permite listar todos los usuarios y grupos del dominio (muy importante para que funcione <code>getent</code>)</li>
<li><code>winbind refresh tickets = yes</code>: mantiene los tickets de Kerberos actualizados</li>
</ul>
<p><strong>Soporte de ACLs de Windows</strong>: Esta parte permite que los permisos de Windows se guarden correctamente en Linux:</p>
<ul>
<li><code>vfs objects = acl_xattr</code>: habilita el almacenamiento de ACLs extendidas</li>
<li><code>map acl inherit = yes</code>: respeta la herencia de permisos de Windows</li>
<li><code>store dos attributes = yes</code>: guarda atributos especiales de Windows (oculto, sistema, etc.)</li>
</ul>
</div>
<p>Finalmente, Verificamos que la configuración es correcta:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>testparm<span class="w"> </span>-s
</span></code></pre></div>
<p>Si hay errores de sintaxis o de cualquier tipo, este comando nos lo dirá y los debemos corregir.</p>
<p>Cuando todo sea correctos nos dirá <code>Loaded services file OK.</code></p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/testparm-s.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/testparm-s.png" width="80%"></a>
<br>
<figcaption>testparm. Verificando fichero smb.conf</figcaption>
</figure>
<p>Puede darse el caso que tengamos algún <code>WARNING</code>, de hecho en la configuración planteada tenemos información redundante y tendremos un <code>WARNING</code>, pero seguiremos sin problemas. </p>
<p>Si no hay errores, recargamos la configuración de Samba:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>sudo<span class="w"> </span>smbcontrol<span class="w"> </span>all<span class="w"> </span>reload-config
</span></code></pre></div>
<p>O reiniciamos los servicios:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>smbd<span class="w"> </span>nmbd
</span></code></pre></div>
<h2 id="union-al-dominio">Unión al dominio</h2>
<p>Con toda la configuración preparada, procedemos a unir el servidor Linux al dominio Active Directory.</p>
<p>Ejecutamos el comando de unión al dominio:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>sudo<span class="w"> </span>net<span class="w"> </span>ads<span class="w"> </span>join<span class="w"> </span>-U<span class="w"> </span>Administrador
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Explicación del comando:</p>
<ul>
<li><code>net ads join</code>: comando de Samba para unirse a un dominio Active Directory</li>
<li><code>-U Administrador</code>: especifica el usuario con permisos para unir equipos al dominio</li>
</ul>
</div>
<p>El sistema nos pedirá la contraseña del usuario Administrador del dominio Windows. La introducimos (no se mostrará mientras escribimos) y pulsamos Enter.</p>
<p>Si todo va bien, veremos un mensaje confirmando que nos hemos unido al dominio correctamente: <code>Joined 'UBUNTUSERVER' to dns domain 'DOMXXX.local'</code>.</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/net-ads-join.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/net-ads-join.png" width="80%"></a>
<br>
<figcaption>Unión al dominio.</figcaption>
</figure>
<p>En la captura vemos algún error de DNS, pero no es critico y podemos seguir con el proceso. </p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/usuarios-equipos-ad.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/usuarios-equipos-ad.png" width="80%"></a>
<br>
<figcaption>Verificación de unión al dominio desde Windows Server.</figcaption>
</figure>
<p>También podemos revisar que el equipo se ha unido al dominio mediante la consola de <strong>Uusuarios y equipos de Active Directory</strong> en nuestro Windows server:</p>
<p>Ahora necesitamos reiniciar y habilitar los servicios de Winbind y Samba para que la configuración tenga efecto:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>winbind<span class="w"> </span>smbd<span class="w"> </span>nmbd
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>winbind<span class="w"> </span>smbd<span class="w"> </span>nmbd
</span></code></pre></div>
<p>El comando <code>enable</code> asegura que estos servicios se inicien automáticamente al arrancar el servidor.</p>
<h2 id="verificacion-de-la-integracion">Verificación de la integración</h2>
<p>Es fundamental verificar que la integración con Active Directory funciona correctamente antes de continuar. Vamos a realizar varias pruebas.</p>
<h3 id="verificar-la-union-al-dominio">Verificar la unión al dominio</h3>
<p>Comprobamos que la unión al dominio es válida:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>sudo<span class="w"> </span>net<span class="w"> </span>ads<span class="w"> </span>testjoin
</span></code></pre></div>
<p>Debe responder: <code>Join is OK</code></p>
<p>Verificamos la comunicación con el controlador de dominio:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>sudo<span class="w"> </span>wbinfo<span class="w"> </span>-t
</span></code></pre></div>
<p>Debe responder: <code>checking the trust secret ... succeeded</code></p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/net-ads-testjoin.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/net-ads-testjoin.png" width="80%"></a>
<br>
<figcaption>Verificación de unión al dominio desde Ubuntu Server.</figcaption>
</figure>
<p>Estos dos comandos confirman que el servidor está correctamente unido al dominio y puede comunicarse con él.</p>
<h3 id="verificar-usuarios-y-grupos-del-dominio">Verificar usuarios y grupos del dominio</h3>
<p>Ahora probamos que el sistema puede ver usuarios del Active Directory. Intentamos obtener información del usuario Administrador:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>id<span class="w"> </span>Administrador
</span></code></pre></div>
<p>Deberíamos ver información del usuario incluyendo su UID, GID y los grupos a los que pertenece. Algo similar a:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>uid=10500(Administrador) gid=10513(domain users) grupos=10513(domain users),10512(domain admins)
</span></code></pre></div>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/id-usuarios.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/id-usuarios.png" width="80%"></a>
<br>
<figcaption>Verificación de unión al dominio. Comprobando usuarios.</figcaption>
</figure>
<p>Listamos todos los usuarios del dominio:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>getent<span class="w"> </span>passwd<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>DOMXXX
</span></code></pre></div>
<p>Deberíamos ver una lista de todos los usuarios del Active Directory. Si no aparece ninguno, es probable que la configuración de enumeración (<code>winbind enum users = yes</code>) no esté activa o que haya algún problema de comunicación.</p>
<p>De forma similar, listamos los grupos:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>getent<span class="w"> </span>group<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>DOMXXX
</span></code></pre></div>
<p>Si estos comandos funcionan correctamente, significa que la integración básica está completa y el sistema puede consultar usuarios y grupos del dominio.</p>
<h2 id="configuracion-de-recursos-compartidos">Configuración de recursos compartidos</h2>
<p>Una vez que tenemos la integración funcionando, podemos crear recursos compartidos que usen la autenticación del dominio y respeten los permisos de Active Directory.</p>
<h3 id="crear-el-directorio-para-compartir">Crear el directorio para compartir</h3>
<p>Vamos a crear una carpeta compartida para el departamento de Informática. Primero creamos el directorio:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/srv/samba/informatica
</span></code></pre></div>
<p>Usamos <code>/srv/samba/</code> como ubicación estándar para recursos compartidos de Samba en Linux.</p>
<h3 id="configurar-permisos-del-sistema-de-archivos">Configurar permisos del sistema de archivos</h3>
<p>Para que Samba pueda gestionar correctamente los permisos de Windows, debemos preparar el sistema de archivos Linux con una configuración específica.</p>
<p>Asignamos el grupo del dominio como propietario:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="s2">"gInformatica"</span><span class="w"> </span>/srv/samba/informatica
</span></code></pre></div>
<p>Establecemos permisos con el bit SGID (Set Group ID):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">2775</span><span class="w"> </span>/srv/samba/informatica
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Explicacion del comando</p>
<p>El <code>2</code> al principio activa el bit SGID, que hace que cualquier archivo o carpeta creado dentro herede automáticamente el grupo propietario (<code>gInformatica</code>). Los permisos <code>775</code> significan:</p>
<ul>
<li>Propietario (root): lectura, escritura y ejecución (7)</li>
<li>Grupo (gInformatica): lectura, escritura y ejecución (7)</li>
<li>Otros: lectura y ejecución (5)</li>
</ul>
</div>
<p>Configuramos las ACLs de POSIX para permitir que Samba gestione las ACLs de Windows. Esto no es obligatorio, pero nos permitirá <strong>gestionar los permisos desde el servidor Windows</strong>. Sin esta configuración los permisos los establecemos únicamente desde el servidor Ubuntu y no podremso cambiar los permisos de los diferentes archivos o carpetas que contegna. </p>
<p>Primero instalaremos el paquete <code>acl</code> que nos permitirá realizar estos ajustes.</p>
<p>Así pues ejecutamos:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>acl
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>sudo<span class="w"> </span>setfacl<span class="w"> </span>-m<span class="w"> </span>g:<span class="s2">"gInformatica"</span>:rwx<span class="w"> </span>/srv/samba/informatica
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>sudo<span class="w"> </span>setfacl<span class="w"> </span>-d<span class="w"> </span>-m<span class="w"> </span>g:<span class="s2">"gInformatica"</span>:rwx<span class="w"> </span>/srv/samba/informatica
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Explicacion de los comandos</p>
<p>El primer comando establece los permisos actuales. El segundo (<code>-d</code>) establece permisos por defecto que se aplicarán automáticamente a cualquier archivo o carpeta creado dentro.</p>
</div>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/samba-informatica.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/samba-informatica.png" width="80%"></a>
<br>
<figcaption>Creaendo carpeta para compartir</figcaption>
</figure>
<h3 id="configurar-el-recurso-compartido-en-samba">Configurar el recurso compartido en Samba</h3>
<p>Editamos nuevamente la configuración de Samba:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/samba/smb.conf
</span></code></pre></div>
<p>Al final del archivo, añadimos la definición del recurso compartido:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">[Informatica]</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">   </span><span class="na">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">Carpeta de equipo gestionada desde Active Directory</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">   </span><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/samba/informatica</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">   </span><span class="na">browseable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">   </span><span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">no</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="w">   </span><span class="na">guest ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">no</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="w">   </span><span class="c1"># Restricción de acceso a nivel de protocolo</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="w">   </span><span class="na">valid users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@gInformatica</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="w">   </span><span class="c1"># Herencia de permisos NTFS</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="w">   </span><span class="na">vfs objects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">acl_xattr</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">   </span><span class="na">map acl inherit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="w">   </span><span class="na">store dos attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="w">   </span><span class="c1"># Máscaras de creación para asegurar compatibilidad</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="w">   </span><span class="na">create mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0664</span>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="w">   </span><span class="na">directory mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0775</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Explicación de las directivas:</p>
<ul>
<li><code>comment</code>: descripción que verán los usuarios al explorar recursos compartidos</li>
<li><code>path</code>: ruta física en el sistema de archivos Linux</li>
<li><code>browseable = yes</code>: el recurso aparecerá al explorar el servidor</li>
<li><code>read only = no</code>: permite escritura (si no, sería de solo lectura)</li>
<li><code>guest ok = no</code>: requiere autenticación, no permite acceso anónimo</li>
<li><code>valid users = @gInformatica</code>: solo usuarios del grupo gInformatica pueden acceder (el <code>@</code> indica que es un grupo)</li>
<li><code>vfs objects</code>, <code>map acl inherit</code>, <code>store dos attributes</code>: permiten la gestión completa de ACLs de Windows</li>
<li><code>create mask</code> y <code>directory mask</code>: permisos por defecto para archivos y carpetas creados</li>
</ul>
</div>
<p>Verificamos que la configuración es correcta:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>testparm<span class="w"> </span>-s
</span></code></pre></div>
<p>Si no hay errores, recargamos la configuración de Samba:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>sudo<span class="w"> </span>smbcontrol<span class="w"> </span>all<span class="w"> </span>reload-config
</span></code></pre></div>
<p>O reiniciamos los servicios:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>smbd<span class="w"> </span>nmbd
</span></code></pre></div>
<h2 id="acceso-desde-windows">Acceso desde Windows</h2>
<p>Llega el momento de la verdad: probar que todo funciona desde un cliente Windows.</p>
<p>Desde un equipo Windows <strong>unido al dominio</strong>, iniciamos sesión con un usuario del dominio que pertenezca al grupo <code>gInformatica</code>.</p>
<p>Abrimos el Explorador de archivos y en la barra de direcciones escribimos:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>\\192.168.100.10
</span></code></pre></div>
<p>o usando el nombre del servidor:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>\\ubuntuserver
</span></code></pre></div>
<p>Deberíamos ver el recurso compartido <strong>Informatica</strong>. Hacemos doble clic para acceder.</p>
<p>Si todo está correctamente configurado:</p>
<ul>
<li>No pedirá credenciales (usa automáticamente las del usuario actual del dominio)</li>
<li>Podemos crear archivos y carpetas</li>
<li>Los archivos creados pertenecerán al usuario del dominio que los creó</li>
</ul>
<h3 id="gestion-de-permisos-desde-windows">Gestión de permisos desde Windows</h3>
<p>Una de las grandes ventajas de usar Winbind con esta configuración es que podemos gestionar permisos directamente desde Windows, usando la interfaz gráfica que ya conocemos.</p>
<p>Dentro del recurso compartido, creamos una carpeta de prueba. Hacemos clic derecho sobre ella y seleccionamos <strong>Propiedades</strong>. Vamos a la pestaña <strong>Seguridad</strong>.</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/carpeta-compartida-windows.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/carpeta-compartida-windows.png" width="98%"></a>
<br>
<figcaption>Carpeta compartida y sus permisos</figcaption>
</figure>
<p>Aquí veremos los permisos actuales. Podemos hacer clic en <strong>Editar</strong> o <strong>Opciones avanzadas</strong> para modificarlos.</p>
<p>Ahora podemos:</p>
<ul>
<li>Añadir usuarios específicos del Active Directory</li>
<li>Asignarles permisos de lectura, escritura, control total, etc.</li>
<li>Configurar herencia de permisos</li>
<li>Todo tal como lo haríamos en un servidor Windows</li>
</ul>
<p>Los cambios que hagamos aquí se guardarán como ACLs extendidas en el sistema de archivos Linux, y Samba las respetará completamente.</p>
<h2 id="verificaciones-finales-desde-el-servidor">Verificaciones finales desde el servidor</h2>
<p>Para verificar que los permisos se están guardando correctamente, podemos consultar las ACLs desde el servidor Linux:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>getfacl<span class="w"> </span>/srv/samba/informatica
</span></code></pre></div>
<p>Deberíamos ver las ACLs de POSIX que configuramos, incluyendo las entradas por defecto para el grupo gInformatica.</p>
<figure align="center">
  <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../imgs/ubuntu/getfacl.png" data-desc-position="bottom"><img alt="Image title" src="../imgs/ubuntu/getfacl.png" width="98%"></a>
<br>
<figcaption>Carpeta compartida y sus permisos</figcaption>
</figure>
<p>Si creamos archivos desde Windows y después listamos el contenido desde Linux:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>ls<span class="w"> </span>-l<span class="w"> </span>/srv/samba/informatica
</span></code></pre></div>
<p>Veremos que los archivos pertenecen a los usuarios del dominio que los crearon.</p>
<p>También podemos verificar que el grupo del dominio está correctamente visible:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>getent<span class="w"> </span>group<span class="w"> </span>gInformatica
</span></code></pre></div>
<p>Debe mostrar el GID y los miembros del grupo del Active Directory.</p>
<h2 id="solucion-de-problemas-comunes">Solución de problemas comunes</h2>
<p>Si algo no funciona como esperamos, aquí hay algunas verificaciones y soluciones:</p>
<p><strong>No puedo acceder al recurso desde Windows</strong>:</p>
<ul>
<li>Verificar que el firewall de Ubuntu permite conexiones Samba: <code>sudo ufw allow samba</code></li>
<li>Comprobar que los servicios están activos: <code>sudo systemctl status smbd nmbd winbind</code></li>
<li>Verificar los logs de Samba: <code>sudo tail -f /var/log/samba/log.smbd</code></li>
</ul>
<p><strong>Los comandos <code>getent</code> no muestran usuarios del dominio</strong>:</p>
<ul>
<li>Verificar que <code>winbind enum users = yes</code> está en <code>smb.conf</code></li>
<li>Reiniciar Winbind: <code>sudo systemctl restart winbind</code></li>
<li>Comprobar la comunicación con el DC: <code>sudo wbinfo -t</code></li>
</ul>
<p><strong>No puedo gestionar permisos desde Windows</strong>:</p>
<ul>
<li>Verificar que las ACLs están habilitadas: <code>sudo tune2fs -l /dev/sda1 | grep acl</code></li>
<li>Asegurar que los permisos del sistema de archivos son correctos (2775 con SGID)</li>
<li>Revisar que <code>vfs objects = acl_xattr</code> está en la configuración del recurso</li>
</ul>
<p><strong>Errores de autenticación Kerberos</strong>:</p>
<ul>
<li>Verificar sincronización de hora: <code>timedatectl</code></li>
<li>Si hay diferencia de más de 5 minutos, la autenticación Kerberos fallará</li>
<li>Instalar y configurar un cliente NTP: <code>sudo apt install chrony</code></li>
</ul>
<p>Con esta configuración completa, tenemos un servidor Linux totalmente integrado con Active Directory, capaz de autenticar usuarios del dominio y gestionar permisos de forma nativa desde Windows. Esta es una configuración profesional que encontraríamos en entornos empresariales reales con infraestructuras híbridas.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pie">
        
          
          <a href="../08_05_instalacion_configuracion_samba/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Instalación y configuración básica de Samba">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Anterior
              </span>
              <div class="md-ellipsis">
                Instalación y configuración básica de Samba
              </div>
            </div>
          </a>
        
        
          
          <a href="../08_07_cron-rsync/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Administración avanzada - Automatización y copias de seguridad">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Siguiente
              </span>
              <div class="md-ellipsis">
                Administración avanzada - Automatización y copias de seguridad
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Sergio Rey Martínez - SMX - SOX - 2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.indexes", "navigation.footer", "navigation.instant", "navigation.instant.progress", "toc.follow", "navigation.top", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>